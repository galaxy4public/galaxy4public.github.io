<!DOCTYPE html>
<html lang="en">
<head>
	<title>Mind Drops :: HOWTO: VMware Player as a remote console (VNC)</title>
		<meta http-equiv="Content-Security-Policy" content="	default-src 'self';object-src 'none';script-src 'self' https://www.googletagmanager.com/gtag/js 'sha256-TelA7VsuYAMqhOKGk7CHgJyuqSJdmqZEp+hn6PWVRwQ=' https://www.google-analytics.com/analytics.js https://static.cloudflareinsights.com/beacon.min.js/v652eace1692a40cfa3763df669d7439c1639079717194;img-src 'self' data: https://www.google-analytics.com/r/collect https://www.google-analytics.com/collect https://stats.g.doubleclick.net/r/collect https://*/ads/ga-audiences https://www.googletagmanager.com/a;style-src 'self' 'sha256-fszvBX/J9dhPxFSJ5wUrq/Pvg6HrnTkWyshMZpaxSQY=';connect-src 'self' https://www.google-analytics.com/j/collect https://stats.g.doubleclick.net/j/collect; " />
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />	<link rel="preload" href="/theme/fonts/Oswald/Oswald-VariableFont_wght.woff2" crossorigin="anonymous" as="font" type="font/woff2">
	<link rel="preload" href="/theme/fonts/Exo2/Exo2-VariableFont_wght.woff2" crossorigin="anonymous" as="font" type="font/woff2">	<link rel="stylesheet" href="/theme/css/fonts/Icons.css" />
	<link rel="stylesheet" href="/theme/css/fonts/Exo2.css" />
	<link rel="stylesheet" href="/theme/css/fonts/Oswald.css" />
	<link rel="stylesheet" href="/theme/css/fonts/DancingScript.css" />
	<link rel="stylesheet" href="/theme/css/base.css" />
	<link rel="stylesheet" href="/theme/css/pygments/default.css" />
	<link rel="canonical" href="/2010/11/24/howto-vmware-player-as-a-remote-console-vnc/" />

	<script type="application/ld+json">
	{
		"@context" : "https://schema.org",
		"@type" : "Article",
		"author": "(GalaxyMaster)",
		"name" : "HOWTO: VMware Player as a remote console (VNC)",
		"datePublished" : "2010-11-24T10:00:00+11:00",
		"dateModified" : "2020-06-14T20:08:33+10:00",
		"articleSection": "hacking",
		"discussionUrl": "https://github.com/galaxy4public/galaxy4public.github.io/issues"
	}
	</script>
</head>

<body>
	<header>
		<span class="flex" data-nosnippet>
			<!--
			<button class="menu-toggle" type="button" tabindex="0" aria-label="Menu Toggle"><div></div></button>
			-->
			<div class="menu-toggle" tabindex="0" aria-label="Menu Toggle"><div></div></div>
			<a href="/" class="logo">
				<picture>
					<source srcset="/images/logo.svg" type="image/svg+xml">
					<source srcset="/images/.svg" type="image/svg+xml">
					<source srcset="/images/.webp" type="image/webp">
					<img width="100%" height="100%" src="/images/" alt="Logo">
				</picture>
				<span class="title">Mind Drops</span>
			</a>
			<nav>
				<ul>
					<li><a class="icon home" href="/">Home</a></li>
					<li><a class="icon user" href="/about">About</a></li>
					<li><a class="icon phone" href="/contact">Contact</a></li>
				</ul>
			</nav>
			<form id="search" role="search" autocomplete="off" method="get" action="/search">
				<label for="q" class="icon search">Search</label>
				<input type="text" name="q" id="q" placeholder="Search..." />
				<div class="help" aria-label="Search ">
					<dl>
						<dt>"search terms"</dt><dd>exact-match</dd>
						<dt>term1 | term2</dt><dd>term1 or term2</dd>
						<dt>term1 * term2</dt><dd>term1 followed by term2</dd>
						<dt>-term</dt><dd>exclude term</dd>
						<dt>(search terms)</dt><dd>groups terms</dd>
						<dt>ext:pdf</dt><dd>file type</dd>
					</dl>
				</div>
			</form>
			<ul class="taskbar">
				<li class="search-toggle"><label for="q" class="icon search offscreen" title="Toggle the search bar">Search</label></li>
				<!-- Not Implemented Yet
				<li><a href="#bug-report" class="icon bug offscreen" title="Report a spotted bug on the page">Report a bug</a></li>
				<li><a href="#preferences" class="icon cog offscreen" title="Configure personal preferences">Preferences</a></li>
				 -->
			</ul>
		</span>
	</header>
<!--
	<aside class="modal">
		<div id="bug-report">
			<a href="#" class="close"></a>
			<div class="content">
				<h1>Bug report</h1>
				<form id="bug-report-form" autocomplete="off">
					<textarea id="bug-report-body" name="bug-report-body">
					</textarea>
					<input type="submit" value="Submit">
				</form>
			</div>
		</div>
		<div id="preferences">
		</div>
	</aside>
 -->
	<main>
			<article id="howto-vmware-player-as-a-remote-console-vnc">
				<header>
					<h1><a href="/2010/11/24/howto-vmware-player-as-a-remote-console-vnc/" rel="bookmark" title="Permalink to HOWTO: VMware Player as a remote console (VNC)">HOWTO: VMware Player as a remote console (VNC)</a></h1>
				</header>
				<aside>
				</aside>
				<p>Since I am doing a lot of remote systems administration tasks due to the nature
of my IT consulting work and since I am also running Linux on all my computers
I was looking for a native way how to get a remote console to VMware VMs from
linux.</p>
<p>After some searching I found that <a href="http://www.vmware.com/go/downloadplayer/">VMware Player</a> (which has native binaries for
Linux) can be used as a VNC client to get to VMs consoles. However, once I have
downloaded VMware Player&rsquo;s bundle and was faced with its requirement to run the
installation script as root I became quite unhappy with an idea of running some
proprietary software on my machine as root, especially after looking into the
bundle and the way the installation script was written. Moreover, there was no
need for other parts of <a href="http://www.vmware.com/go/downloadplayer/">VMware Player</a> &ndash; I just wanted to have a small tool to
be able to hook the remote consoles up under my lovely Linux environment.
Therefore, I decided to take a challenge and to tweak the installation so it
will be possible to install the whole thing as a non-privileged user. Another
sub-goal was to strip the installation further down and prepare a small package
with only components needed for remote console sessions.</p>
<p>If you are not concerned about security (and integrity) of your system, e.g.
you are fine with the re-installation of the whole system, then it will be
cheaper to just install the <a href="http://www.vmware.com/go/downloadplayer/">VMware Player</a> under the root account. In this case
you don&rsquo;t need to read any further since what I am describing below is for
those brave hearts who value their systems and who do not want to give a chance
to mess their systems up by running low-quality custom installation scripts as
root.</p>
<p>Well, if you are still reading, then I hope that my research on this topic and
the how-to I have spent considerable time to come up with is worth something
and will be of some help to you.</p>
<p>Our starting point is a Linux-based system (it does not matter what
distribution you are running, but I did everything on a customised <a href="https://en.altlinux.org/">ALT Linux</a>&rsquo;s
RPM-based distribution) running on an x86 compatible hardware (mine was 32-bit,
but I see no issues with 64-bit ones).</p>
<p>The first step is to download <a href="http://www.vmware.com/go/downloadplayer/">VMware Player</a> for your architecture, set proper
permissions on the downloaded file, and then extract the payload as follows
(you need to ensure that you have at least 40MB of free space on <code>/tmp</code>, BTW):</p>
<pre class="highlight"><input type="radio" name="code_menud0430ffeb3bf8838f1edbe26c153dccf8581f910" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menud0430ffeb3bf8838f1edbe26c153dccf8581f910" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">0700</span><span class="w"> </span>./VMware-Player-3.1.3.324285.i386.bundle
</div><div class="line"><a></a><span class="gp">$ </span>./VMware-Player-3.1.3-324285.i386.bundle<span class="w"> </span>--console<span class="w"> </span>-x<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/vmplayer
</div><div class="line"><a></a><span class="go">Extracting VMware Installer...done.</span>
</div><div class="line"><a></a><span class="go">No protocol specified</span>
</div><div class="line"><a></a><span class="go">No protocol specified</span>
</div><div class="line"><a></a><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>vmplayer
</div><div class="line"><a></a><span class="go">total 20</span>
</div><div class="line"><a></a><span class="go">drwxr-xr-x  8 vmware vmware 4096 Nov 23 09:01 vmware-installer</span>
</div><div class="line"><a></a><span class="go">drwxr-xr-x  4 vmware vmware 4096 Nov 23 09:01 vmware-ovftool</span>
</div><div class="line"><a></a><span class="go">drwxr-xr-x  5 vmware vmware 4096 Nov 23 09:01 vmware-player</span>
</div><div class="line"><a></a><span class="go">drwxr-xr-x 11 vmware vmware 4096 Nov 23 09:01 vmware-player-app</span>
</div><div class="line"><a></a><span class="go">drwxr-xr-x  3 vmware vmware 4096 Nov 23 09:01 vmware-player-setup</span></div></code></pre>
<p>So far so good. We now have the whole bundle unacked into the specified
directory and we are interested in just two subdirectories: <code>vmware-player</code> and
<code>vmware-player-app</code>, the rest is not related to the functionality we are
looking for.</p>
<p>Now, let&rsquo;s pick up all parts from which we will build our future &ldquo;VMware remote
console&rdquo; tool. To make it easier create a dedicated subdirectory, e.g.
<code>vmrconsole</code>, with the following structure:</p>
<pre class="highlight"><input type="radio" name="code_menu671b69b4eb718edcf04f1b8dd250501a7c9475cd" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu671b69b4eb718edcf04f1b8dd250501a7c9475cd" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole
</div><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole/<span class="o">{</span>bin,etc,lib,share<span class="o">}</span>
</div><div class="line"><a></a><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>~/vmrconsole
</div><div class="line"><a></a><span class="go">total 12</span>
</div><div class="line"><a></a><span class="go">drwx------ 2 vmware vmware 4096 Nov 24 01:21 bin</span>
</div><div class="line"><a></a><span class="go">drwx------ 2 vmware vmware 4096 Nov 24 01:21 etc</span>
</div><div class="line"><a></a><span class="go">drwx------ 2 vmware vmware 4096 Nov 24 01:21 lib</span>
</div><div class="line"><a></a><span class="go">drwx------ 2 vmware vmware 4096 Nov 24 01:21 share</span></div></code></pre>
<p>From now on we are going to populate these directories with files from the
unpacked bundle.</p>
<p>The first file we are interested in is <code>appLoader</code> &ndash; this is the primary
executable by the way, we need to copy it to our bin directory and then try to
run it:</p>
<pre class="highlight"><input type="radio" name="code_menu6e0f2184bfea62751c340bd5990747a4aa7da46f" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu6e0f2184bfea62751c340bd5990747a4aa7da46f" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>~/vmplayer/vmware-player-app/lib/bin/appLoader<span class="w"> </span>~/vmrconsole/bin/
</div><div class="line"><a></a><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">0700</span><span class="w"> </span>~/vmrconsole/bin/appLoader
</div><div class="line"><a></a><span class="gp">$ </span>ln<span class="w"> </span>-s<span class="w"> </span>appLoader<span class="w"> </span>~/vmrconsole/bin/vmplayer
</div><div class="line"><a></a><span class="gp">$ </span>~/vmrconsole/bin/vmplayer<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
</div><div class="line"><a></a><span class="go">255</span>
</div><div class="line"><a></a><span class="gp">$</span></div></code></pre>
<p>Huh, this is not very informative, is it? The binary silently exits with error
code of 255. Well, you may get other errors at this stage if you don&rsquo;t have all
the required shared libraries installed on you system &ndash; however I doubt it
since the requirements of this binary are pretty reasonable: glibc and zlib.</p>
<p>OK, let&rsquo;s take a peek inside and figure out what is going on (originally I used
strace with logging to a file, but to keep this article reasonable short I am
highlighting important things only):</p>
<pre class="highlight"><input type="radio" name="code_menu4ae200eaf3e64f4f0bc16db599c9acbc826beef5" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu4ae200eaf3e64f4f0bc16db599c9acbc826beef5" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>strace<span class="w"> </span>-f<span class="w"> </span>-eopen<span class="w"> </span>~/vmrconsole/bin/vmplayer<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-2
</div><div class="line"><a></a><span class="go">open(&quot;/etc/localtime&quot;, O_RDONLY)        = 6</span>
</div><div class="line"><a></a><span class="go">open(&quot;/etc/vmware/config&quot;, O_RDONLY|O_LARGEFILE) = -1 EACCES (Permission denied)</span></div></code></pre>
<p>It looks that vmplayer wants to access a global config file and does not try to
look for an alternative, home directory based one. Well, this is understandable
since VMware folks did not expect it to be run as a non-privileged process, but
we need to deal with this somehow. What are our options here? The simpliest
option I could think of at the moment is to substitute the hardcoded absolute
path inside the binary with something relative:</p>
<pre class="highlight"><input type="radio" name="code_menufa5f1ece6a6d7b5404f8ebfe43110a2633360d88" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menufa5f1ece6a6d7b5404f8ebfe43110a2633360d88" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>~/vmrconsole/bin/appLoader<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/etc/vmware<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c
</div><div class="line"><a></a><span class="go">      1 /etc/vmware/config</span>
</div><div class="line"><a></a><span class="go">      1 /etc/vmware/icu</span>
</div><div class="line"><a></a><span class="go">      1 /etc/vmware/ssl/rui.crt</span>
</div><div class="line"><a></a><span class="go">      1 /etc/vmware/ssl/rui.key</span>
</div><div class="line"><a></a><span class="go">      1 /etc/vmware/ssl/dh512.pem</span>
</div><div class="line"><a></a><span class="go">      1 /etc/vmware/ssl/dh1024.pem</span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware,..//////etc,g&#39;</span><span class="w"> </span>~/vmrconsole/bin/appLoader</div></code></pre>
<p>The trick here is to substitute one string with another of the same length (we
are modifying a binary so we do not want to mess offsets up) and luckily enough
we can use whatever number of slashes we want &ndash; they all are considered as a
single separator nevertheless. OK, we could have used a hex editor and could
have terminated strings with a NULL byte, but the point is that the approach I
took is the quickest and is working well. Let&rsquo;s run the modified binary through
strace again, but this time we need to be prepared for the changed behaviour:</p>
<pre class="highlight"><input type="radio" name="code_menu81cf7a00d6699e31f52bcad5fda20d47a589a27a" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu81cf7a00d6699e31f52bcad5fda20d47a589a27a" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/vmrconsole/bin/
</div><div class="line"><a></a><span class="gp">$ </span>touch<span class="w"> </span>../etc/config
</div><div class="line"><a></a><span class="gp">$ </span>strace<span class="w"> </span>-f<span class="w"> </span>-emkdir,lstat,open,write<span class="w"> </span>./vmplayer<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-12
</div><div class="line"><a></a><span class="go">mkdir(&quot;/tmp/.private/vmware/vmware-vmplayer&quot;, 0700) = -1 EEXIST (File exists)</span>
</div><div class="line"><a></a><span class="go">open(&quot;/tmp/.private/vmware/vmware-vmplayer/appLoader-9245.log&quot;, O_RDWR|O_CREAT|O_APPEND|O_LARGEFILE, 0644) = 5</span>
</div><div class="line"><a></a><span class="go">open(&quot;/etc/localtime&quot;, O_RDONLY)        = 6</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.824: app-3077760&quot;..., 121) = 121</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.824: app-3077760&quot;..., 60) = 60</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.824: app-3077760&quot;..., 71) = 71</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.824: app-3077760&quot;..., 57) = 57</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;\&quot;\n&quot;, 2)                     = 2</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.825: app-3077760&quot;..., 82) = 82</span>
</div><div class="line"><a></a><span class="go">open(&quot;..//////etc/config&quot;, O_RDONLY|O_LARGEFILE) = 6</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.825: app-3077760&quot;..., 89) = 89</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;Nov 24 01:53:09.825: app-3077760&quot;..., 73) = 73</span></div></code></pre>
<p>Looks better, does not it? Our binary found the config file and was able to
open it, however it still produces no output, but it reports something to a log
file:</p>
<pre class="highlight"><input type="radio" name="code_menub1927adfde05d1513ec5d5e710ff3f9be2ce46ea" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menub1927adfde05d1513ec5d5e710ff3f9be2ce46ea" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>tail<span class="w"> </span>-7<span class="w"> </span>/tmp/.private/vmware/vmware-vmplayer/appLoader-9245.log
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.824: app-3077760704| Log for VMware Workstation pid=9245 version=7.1.3 build=build-324285 option=Release</span>
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.824: app-3077760704| The process is 32-bit.</span>
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.824: app-3077760704| Host codepage=utf8 encoding=UTF-8</span>
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.824: app-3077760704| Calling: &quot;./vmplayer&quot;</span>
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.825: app-3077760704| Using configuration file ..//////etc/config.</span>
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.825: app-3077760704| libdir entry was not present in ..//////etc/config.</span>
</div><div class="line"><a></a><span class="go">Nov 24 01:53:09.825: app-3077760704| Unable to lookup library directory.</span></div></code></pre>
<p>I do not know much about VMware Players config file but according to the log
message it wants some variable called <code>libdir</code> and this variable should point
to the library directory, so let&rsquo;s introduce such a variable and try to execute
the binary again:</p>
<pre class="highlight"><input type="radio" name="code_menudf4d0c8c7e1e3e92025f53597aa63066c6b6da42" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menudf4d0c8c7e1e3e92025f53597aa63066c6b6da42" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;libdir = ..&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>../etc/config
</div><div class="line"><a></a><span class="gp">$ </span>strace<span class="w"> </span>-f<span class="w"> </span>-emkdir,lstat,open,write<span class="w"> </span>./vmplayer<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-4
</div><div class="line"><a></a><span class="go">write(5, &quot;LOG NOT INITIALIZED | LoadLibrar&quot;..., 73) = 73</span>
</div><div class="line"><a></a><span class="go">open(&quot;../lib/libvmplayer.so/libvmplayer.so&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;LOG NOT INITIALIZED | Error load&quot;..., 153) = 153</span>
</div><div class="line"><a></a><span class="go">write(5, &quot;LOG NOT INITIALIZED | Could not &quot;..., 74) = 74</span></div></code></pre>
<p>I hope you have noticed that I have used a relative path for the library
directory in the config file and this means that we always should run the
binary with its directory being the current working directory. This is a bit
inconvenient, but we will solve this with a wrapper script later. Right now, we
need to get it working and we see that it tried to dynamically load some
library from the library directory. OK, let&rsquo;s search for this library in the
unpacked bundle directory and copy the library file over to our tree:</p>
<pre class="highlight"><input type="radio" name="code_menu9a5a71ae36bfde4ce40d752382374d57ef5a07b1" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu9a5a71ae36bfde4ce40d752382374d57ef5a07b1" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-name<span class="w"> </span>libvmplayer.so
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/lib/lib/libvmplayer.so</span>
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/lib/lib/libvmplayer.so/libvmplayer.so</span>
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-a<span class="w"> </span>~/vmplayer/vmware-player-app/lib/lib/libvmplayer.so<span class="w"> </span>~/vmrconsole/lib/
</div><div class="line"><a></a><span class="gp">$ </span>ldd<span class="w"> </span>~/vmrconsole/lib/libvmplayer.so/libvmplayer.so<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span><span class="s1">&#39;not found&#39;</span>
</div><div class="line"><a></a><span class="go"> libview.so.2 =&gt; not found</span>
</div><div class="line"><a></a><span class="go"> libcds.so =&gt; not found</span>
</div><div class="line"><a></a><span class="go"> libvmwarebase.so.0 =&gt; not found</span>
</div><div class="line"><a></a><span class="go"> libvmwareui.so.0 =&gt; not found</span>
</div><div class="line"><a></a><span class="go"> libgvmomi.so.0 =&gt; not found</span></div></code></pre>
<p>The last command showed that <code>libvmplayer.so</code> depends on some libraries and
that their locations are currently unknown to the system. In order to solve
this there are two things we need to do:</p>
<ol>
<li>We need to tell the system where it should search for the libraries;</li>
<li>We need to locate these libraries and put them into a directory where the
   system will find them.</li>
</ol>
<p>To accomplish the first thing we need to create a wrapper script around
vmplayer and use this script for fine-tuning later. Here is the very basic
script for this purpose (created as <code>~/vmrconsole/bin/loader.sh</code>):</p>
<pre class="highlight"><input type="radio" name="code_menu4e354732137fc6713490e741fbd8dcc08e8d5c4b" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu4e354732137fc6713490e741fbd8dcc08e8d5c4b" class="line-numbers icon list-numbered"><code class="language-bash" data-file="~/vmrconsole/bin/loader.sh"><div class="line"><a></a><span class="ch">#!/bin/bash</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># We must run vmplayer from the directory it resides in since all</span>
</div><div class="line"><a></a><span class="c1"># relative paths are solved from there.</span>
</div><div class="line"><a></a><span class="nv">ORIG_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
</div><div class="line"><a></a><span class="nv">ABS_NAME</span><span class="o">=</span><span class="k">$(</span>readlink<span class="w"> </span>-e<span class="w"> </span><span class="nv">$BASH_SOURCE</span><span class="k">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</div><div class="line"><a></a><span class="nv">VMW_BINDIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ABS_NAME</span><span class="p">%/*</span><span class="si">}</span><span class="s2">&quot;</span>
</div><div class="line"><a></a><span class="nv">VMW_LIBDIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$VMW_BINDIR</span><span class="s2">/../lib&quot;</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># check that directories exist, if not notify the user</span>
</div><div class="line"><a></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$VMW_BINDIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: cannot determine the directory where this script resides!&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</div><div class="line"><a></a><span class="k">fi</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># preserve the current working directory</span>
</div><div class="line"><a></a><span class="nv">OLD_PWD</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">&quot;</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$VMW_LIBDIR</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: the &#39;</span><span class="nv">$VMW_LIBDIR</span><span class="s2">&#39; directory does not exist!&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</div><div class="line"><a></a><span class="k">fi</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># resolve the library directory path (to get rid off ../ inside of it)</span>
</div><div class="line"><a></a><span class="nv">VMW_LIBDIR</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="w"> </span>-P<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="k">)</span>
</div><div class="line"><a></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span>-o<span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$VMW_LIBDIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: could not resolve the &#39;</span><span class="nv">$VMW_LIBDIR</span><span class="s2">&#39; directory path!&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</div><div class="line"><a></a><span class="k">fi</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># return back since it possible that we were called as ./vmrconsole</span>
</div><div class="line"><a></a><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$OLD_PWD</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: could not return to the original &#39;</span><span class="nv">$OLD_PWD</span><span class="s2">&#39; directory!&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</div><div class="line"><a></a><span class="k">fi</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># we don&#39;t need the following variable anymore</span>
</div><div class="line"><a></a><span class="nb">unset</span><span class="w"> </span>OLD_PWD
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># change the current directory to $VMW_BINDIR</span>
</div><div class="line"><a></a><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$VMW_BINDIR</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ERROR: failed to change directory to &#39;</span><span class="nv">$VMW_BINDIR</span><span class="s2">&#39;!&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
</div><div class="line"><a></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</div><div class="line"><a></a><span class="k">fi</span>
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># set the library search path so the dynamic linker will be able</span>
</div><div class="line"><a></a><span class="c1"># to locate locally installed libraries.</span>
</div><div class="line"><a></a><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$VMW_LIBDIR</span><span class="si">${</span><span class="nv">LD_LIBRARY_PATH</span><span class="p">:+:</span><span class="nv">$LD_LIBRARY_PATH</span><span class="si">}</span><span class="s2">&quot;</span>
</div><div class="line"><a></a><span class="nb">export</span><span class="w"> </span>LD_LIBRARY_PATH
</div><div class="line"><a></a>
</div><div class="line"><a></a><span class="c1"># execute the real binary and pass the supplied arguments to it</span>
</div><div class="line"><a></a><span class="nb">exec</span><span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ORIG_NAME</span><span class="s2">&quot;</span><span class="w"> </span>./appLoader<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span></div></code></pre>
<p>This wrapper script should not be called directly, instead we need to create a
symbolic link to this wrapper, e.g. for vmplayer the following should be
performed:</p>
<pre class="highlight"><input type="radio" name="code_menu0b0f3afe6e1cfc7c272ff4e5b5a2d0638526e918" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu0b0f3afe6e1cfc7c272ff4e5b5a2d0638526e918" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>ln<span class="w"> </span>-sf<span class="w"> </span>loader.sh<span class="w"> </span>~/vmrconsole/bin/vmplayer</div></code></pre>
<p>Since our vmplayer is not a full scale VMware Player I suggest to create
another small wrapper script and name it <code>vmrconsole</code>:</p>
<pre class="highlight"><input type="radio" name="code_menu18fe0c2d1ce758c536aa91d9a492d3b1bb25f001" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu18fe0c2d1ce758c536aa91d9a492d3b1bb25f001" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>cat<span class="w"> </span>~/vmrconsole/bin/vmrconsole
</div><div class="line"><a></a><span class="gp">#</span>!/bin/bash
</div><div class="line"><a></a><span class="go">ABS_NAME=$(readlink -e $BASH_SOURCE) || exit 1</span>
</div><div class="line"><a></a><span class="go">BINDIR=&quot;${ABS_NAME%/*}&quot;</span>
</div><div class="line"><a></a><span class="go">exec &quot;$BINDIR/vmplayer&quot; -h &quot;$@&quot;</span>
</div><div class="line"><a></a><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">0700</span><span class="w"> </span>~/vmrconsole/bin/vmrconsole</div></code></pre>
<p>Now we need to populate our library directory with the needed libraries. It is
a bit tricky to describe since on different systems you will likely end up with
different sets of libraries inside our local directory. For example, on my
system I have quite a few of the libraries installed from the distribution
repositories and these versions of libraries are fresher and with many bug
fixes in comparison to the VMWare provided ones.</p>
<p>Anyway, the general approach to install missing libraries is the following &ndash;
we start with the libraries we determined as missing during our <code>ldd
~/vmrconsole/lib/libvmplayer.so/libvmplayer.so | fgrep 'not found'</code> step (we
need to locate and copy them over to our library directory):</p>
<pre class="highlight"><input type="radio" name="code_menub14f327cbc9fb751f78885e73b17778abc3a1fe1" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menub14f327cbc9fb751f78885e73b17778abc3a1fe1" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>ldd<span class="w"> </span>~/vmrconsole/lib/libvmplayer.so/libvmplayer.so<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span><span class="s1">&#39;not found&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{ print $1; }&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-i<span class="w"> </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-name<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span>-execdir<span class="w"> </span>cp<span class="w"> </span>-avL<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span>~/vmrconsole/lib/<span class="w"> </span><span class="se">\;</span>
</div><div class="line"><a></a><span class="go">`libview.so.2&#39; -&gt; `/home/vmware/vmrconsole/lib/libview.so.2&#39;</span>
</div><div class="line"><a></a><span class="go">`libcds.so&#39; -&gt; `/home/vmware/vmrconsole/lib/libcds.so&#39;</span>
</div><div class="line"><a></a><span class="go">`libvmwarebase.so.0&#39; -&gt; `/home/vmware/vmrconsole/lib/libvmwarebase.so.0&#39;</span>
</div><div class="line"><a></a><span class="go">`libvmwareui.so.0&#39; -&gt; `/home/vmware/vmrconsole/lib/libvmwareui.so.0&#39;</span>
</div><div class="line"><a></a><span class="go">`libgvmomi.so.0&#39; -&gt; `/home/vmware/vmrconsole/lib/libgvmomi.so.0&#39;</span></div></code></pre>
<p>Once this is done we need to follow the following loop until there is no output
from the command listed below (in fact, on my system this step was not needed
since I had all dependencies in place already, but it is harmless to execute
this command anyway):</p>
<pre class="highlight"><input type="radio" name="code_menuf4a2106e349d3f74c0d85c95ec5a0e89b7f1e7ea" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menuf4a2106e349d3f74c0d85c95ec5a0e89b7f1e7ea" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>~/vmrconsole/lib<span class="w"> </span>ldd<span class="w"> </span>~/vmrconsole/lib/*<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span><span class="s1">&#39;not found&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{ print $1; }&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-i<span class="w"> </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-name<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span>-execdir<span class="w"> </span>cp<span class="w"> </span>-avL<span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span>~/vmrconsole/lib/<span class="w"> </span><span class="se">\;</span></div></code></pre>
<p>If we try to access any remote VM&rsquo;s console it will be clear that some parts
are still missing:</p>
<pre class="highlight"><input type="radio" name="code_menu7cf363685678f18aa0b3a423b48e52b3099af2ee" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu7cf363685678f18aa0b3a423b48e52b3099af2ee" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>vmrconsole<span class="w"> </span><span class="m">192</span>.168.70.31
</div><div class="line"><a></a><span class="go">Failed to open file &#39;/usr/lib/vmware/share/pixmaps/progress.png&#39;: No such file or directory</span>
</div><div class="line"><a></a><span class="go">Failed to open file &#39;/usr/lib/vmware/share/pixmaps/eula.png&#39;: No such file or directory</span>
</div><div class="line"><a></a><span class="go">Failed to open file &#39;/usr/lib/vmware/share/pixmaps/stream-spinner.png&#39;: No such file or directory</span>
</div><div class="line"><a></a><span class="go">Failed to open file &#39;/usr/lib/vmware/share/pixmaps/stream-spinner-stopped.png&#39;: No such file or directory</span>
</div><div class="line"><a></a><span class="go">SSLLoadSharedLibrary: Failed to load library libcrypto.so.0.9.8:/home/vmplayer/vmrconsole/bin/libdir/lib/libcrypto.so.0.9.8/libcrypto.so.0.9.8: cannot open shared object file: No such file or directory</span></div></code></pre>
<p><code>strace</code> is our best friend here, just run the command through <code>strace</code>,
examine the log file, and fix stuff properly:</p>
<pre class="highlight"><input type="radio" name="code_menu088c392045e601120b4d2f40a7957ccc81be3b63" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu088c392045e601120b4d2f40a7957ccc81be3b63" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>strace<span class="w"> </span>-f<span class="w"> </span>-eopen<span class="w"> </span>-o<span class="w"> </span>~/strace.log<span class="w"> </span>vmrconsole<span class="w"> </span><span class="m">192</span>.168.70.31<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</div><div class="line"><a></a><span class="gp">$ </span>less<span class="w"> </span>-n<span class="w"> </span>~/strace.log
</div><div class="line"><a></a><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/vmrconsole/lib
</div><div class="line"><a></a><span class="gp">$ </span>fgrep<span class="w"> </span>-lr<span class="w"> </span>/vmware<span class="w"> </span>*
</div><div class="line"><a></a><span class="go">libcds.so</span>
</div><div class="line"><a></a><span class="go">libgvmomi.so.0</span>
</div><div class="line"><a></a><span class="go">libvmplayer.so/libvmplayer.so</span>
</div><div class="line"><a></a><span class="go">libvmwarebase.so.0</span>
</div><div class="line"><a></a><span class="go">libvmwareui.so.0</span>
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>libcds.so<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/vmware
</div><div class="line"><a></a><span class="go">/etc/vmware/bootstrap</span>
</div><div class="line"><a></a><span class="go">/etc/vmware-installer/bootstrap</span>
</div><div class="line"><a></a><span class="go">/etc/vmware-installer/database</span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware/,..//////etc/,&#39;</span><span class="w"> </span>libcds.so<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware-installer/,..//////etc/installer/,&#39;</span><span class="w"> </span>libcds.so<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>libgvmomi.so.0<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/vmware
</div><div class="line"><a></a><span class="go">/etc/vmware/hostd/proxy.xml</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/icu</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/rui.crt</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/rui.key</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/dh512.pem</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/dh1024.pem</span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware/,..//////etc/,g&#39;</span><span class="w"> </span>libgvmomi.so.0
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>libvmplayer.so/libvmplayer.so<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/vmware
</div><div class="line"><a></a><span class="go">/usr/lib/vmware</span>
</div><div class="line"><a></a><span class="go">bin/vmware-vmrc-daemon</span>
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>libvmwarebase.so.0<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/vmware
</div><div class="line"><a></a><span class="go">/etc/vmware/config</span>
</div><div class="line"><a></a><span class="go">/usr/lib/vmware</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/icu</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/CVP</span>
</div><div class="line"><a></a><span class="go">vmauthd/vmware-authd</span>
</div><div class="line"><a></a><span class="go">/usr/sbin/vmware-authd</span>
</div><div class="line"><a></a><span class="go">/var/run/vmware/authd_</span>
</div><div class="line"><a></a><span class="go">/var/run/vmware</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/rui.crt</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/rui.key</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/dh512.pem</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/dh1024.pem</span>
</div><div class="line"><a></a><span class="go">/var/run/vmware/usbarbitrator-socket</span>
</div><div class="line"><a></a><span class="go">/usr/lib/vmware/settings</span>
</div><div class="line"><a></a><span class="go">/usr/lib/vmware/config</span>
</div><div class="line"><a></a><span class="go">bin/vmware-vmx</span>
</div><div class="line"><a></a><span class="go">bin/vmware-vmx-debug</span>
</div><div class="line"><a></a><span class="go">bin/vmware-vmx-stats</span>
</div><div class="line"><a></a><span class="gp">%</span>s/vmware-speedtest-%d.tmp
</div><div class="line"><a></a><span class="go">/etc/vmware/vmware-ace/host.vmpl</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/vmware-ace/host-update.vmpl</span>
</div><div class="line"><a></a><span class="go">/etc/vmware</span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware/,..//////etc/,g&#39;</span><span class="w"> </span>libvmwarebase.so.0<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware,..//////etc,g&#39;</span><span class="w"> </span>libvmwarebase.so.0<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/usr/lib/vmware/,..//////////etc/,g&#39;</span><span class="w"> </span>libvmwarebase.so.0<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/var/run/vmware,..//////var/run,g&#39;</span><span class="w"> </span>libvmwarebase.so.0<span class="w"> </span>
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>libvmwareui.so.0<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/usr/lib/vmware
</div><div class="line"><a></a><span class="go">/usr/lib/vmware</span>
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>libvmwareui.so.0<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/var/run/vmware
</div><div class="line"><a></a><span class="go">/var/run/vmware/fuse/%Lu.info</span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/var/run/vmware,..//////var/run,g&#39;</span><span class="w"> </span>libvmwareui.so.0</div></code></pre>
<p>Ufff, we did a lot of binary patching &ndash; luckily, VMware binaries and libraries
are not calculating their checksums. Now, we need to put all this stuff we have
seen in the <code>strings</code> output and during the execution of the program in place (in
accordance to our new relative paths):</p>
<pre class="highlight"><input type="radio" name="code_menud1b7f9d99817d921012c33e357b4dba56040e2fc" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menud1b7f9d99817d921012c33e357b4dba56040e2fc" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-name<span class="w"> </span>icu
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/lib/icu</span>
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/icu<span class="w"> </span>~/vmrconsole/etc/
</div><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole/etc/ssl
</div><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-name<span class="w"> </span>CVP
</div><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole/var
</div><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole/var/run
</div><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-name<span class="w"> </span>pixmaps
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player/lib/share/pixmaps</span>
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/lib/share/pixmaps</span>
</div><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole/share/pixmaps
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/share/pixmaps/*<span class="w"> </span>~/vmrconsole/share/pixmaps/
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/share/EULA.txt<span class="w"> </span>~/vmrconsole/share/
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/share/*.ui<span class="w"> </span>~/vmrconsole/share/
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/share/icons<span class="w"> </span>~/vmrconsole/share/</div></code></pre>
<p>At this stage we should be able to launch the vmplayer program via our wrapper
script (I am launching it on a remote machine through SSH, but here I am
describing how it should look on the local console):</p>
<pre class="highlight"><input type="radio" name="code_menu8132eeb291fc17723d330c6b2561f95ad76ecb76" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu8132eeb291fc17723d330c6b2561f95ad76ecb76" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>~/vmrconsole/bin/vmplayer</div></code></pre>
<p><img alt="VMware Player: main window" class="figure" src="../../../../images/howto-vmware-player-as-remote-console-01.jpg"></p>
<p>So far so good, but we need to resolve the issue with the OpenSSL library
dependency. To resolve the issue we need to create symbolic links from our
local library directory to the system-wide version of the OpenSSL library:</p>
<pre class="highlight"><input type="radio" name="code_menu5ae87b0932b09db778547b88a981ac6c3944a833" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu5ae87b0932b09db778547b88a981ac6c3944a833" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/lib/libcrypto.so.0.9.8<span class="w"> </span>~/vmrconsole/lib/
</div><div class="line"><a></a><span class="gp">$ </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/lib/libssl.so.0.9.8<span class="w"> </span>~/vmrconsole/lib/
</div><div class="line"><a></a><span class="gp">$ </span>ls<span class="w"> </span>-ld<span class="w"> </span>~/vmrconsole/lib/lib*.so.0.9.8<span class="w"> </span>
</div><div class="line"><a></a><span class="go">lrwxrwxrwx 1 vmware vmware 27 Nov 24 05:27 /home/vmware/vmrconsole/lib/libcrypto.so.0.9.8 -&gt; /usr/lib/libcrypto.so.0.9.8</span>
</div><div class="line"><a></a><span class="go">lrwxrwxrwx 1 vmware vmware 27 Nov 24 05:27 /home/vmware/vmrconsole/lib/libssl.so.0.9.8 -&gt; /usr/lib/libssl.so.0.9.8</span></div></code></pre>
<p>Let&rsquo;s try to connect to remote VM&rsquo;s console again:</p>
<pre class="highlight"><input type="radio" name="code_menub9364a57d299f808ce5b4cccb7a7b5b61b54163c" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menub9364a57d299f808ce5b4cccb7a7b5b61b54163c" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>vmrconsole<span class="w"> </span><span class="m">192</span>.168.70.31</div></code></pre>
<p><img alt="VMware Player: credentials window" class="figure" src="../../../../images/howto-vmware-player-as-remote-console-02.jpg"></p>
<p><img alt="VMware Player: MKS error message" class="figure" src="../../../../images/howto-vmware-player-as-remote-console-03.jpg"></p>
<p>Well, this error message does not say much except that we are not getting our
console :). If we check the log file directory we would see there is a file
called <code>player-XXXXX.log</code> (where XXXXX is the PID of the VMware Player that
produced this log file). Inside the log file we may see some interesting parts
like the following (I have included only those messages which are related to our
task):</p>
<pre class="highlight"><input type="radio" name="code_menub211ec4dd96ef8c94e73b9a8f3a787fe05b173df" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menub211ec4dd96ef8c94e73b9a8f3a787fe05b173df" class="line-numbers icon list-numbered"><code class="language-syslog"><div class="line"><a></a>Nov 24 03:40:42.002: player| CDS error: Cannot locate VMIS, bootstrap file /etc/vmware-installer/bootstrap unavailable!
</div><div class="line"><a></a>Nov 24 03:40:42.072: player| Unable to launch vmplayer-daemon: File does not exist.
</div><div class="line"><a></a>Nov 24 03:40:42.072: player| Unable to find /home/vmplayer/bin/vmware-unity-helper in attempt to launch daemon.
</div><div class="line"><a></a>Nov 24 03:41:04.630: player| Player dispatch: Opening VM while not connected to the daemon.
</div><div class="line"><a></a>Nov 24 03:41:05.437: player| ConnectMksClient - calling VMClient_ConnectMksClientEx
</div><div class="line"><a></a>Nov 24 03:41:05.437: player| VMClient_ConnectMksClientEx - trying local socket connection
</div><div class="line"><a></a>Nov 24 03:41:05.444: player| Cnx_Connect: Returning false because CnxConnectAuthd failed
</div><div class="line"><a></a>Nov 24 03:41:05.444: player| Cnx_Connect: Error message: Connection terminated by server
</div><div class="line"><a></a>Nov 24 03:41:05.444: player| VMClient_ConnectMksClientEx - trying remote socket connection
</div><div class="line"><a></a>Nov 24 03:41:05.611: player| VMClient_ConnectMksClientEx - connecting the MKS client
</div><div class="line"><a></a>Nov 24 03:41:05.616: player| vmdbPipe_Streams: Couldn&#39;t read
</div><div class="line"><a></a>Nov 24 03:41:15.941: player| Gdk: losing last reference to undestroyed window</div></code></pre>
<p>From the messages quoted above it is quite clear that the program is trying to
launch some helper binaries/daemons in the background and to delegate the
actual remote console task to them. You can <code>strace</code>/<code>ltrace</code> the whole thing,
review the resulting logs and you will find that it tries to execute two helper
binaries: <code>vmware-authd</code> and <code>vmware-remotemks</code>, the latter is the remote
console engine, while the former is some kind of an authentication daemon and I
do not think it is needed for our purposes. I am not going to describe in
details how I arrived at the following (it is all clear once you have studied
the <code>strace</code>/<code>ltrace</code> log files):</p>
<pre class="highlight"><input type="radio" name="code_menu3bf96dc5fc7c75dbb2ff58cd7754b0feebc44e78" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu3bf96dc5fc7c75dbb2ff58cd7754b0feebc44e78" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-name<span class="w"> </span>vmware-authd<span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span>vmware-remotemks
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/lib/bin/vmware-remotemks</span>
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/sbin/vmware-authd</span>
</div><div class="line"><a></a><span class="gp">$ </span>mkdir<span class="w"> </span>-m700<span class="w"> </span>~/vmrconsole/vmauthd
</div><div class="line"><a></a><span class="gp">$ </span>ln<span class="w"> </span>-s<span class="w"> </span><span class="sb">`</span>which<span class="w"> </span><span class="nb">true</span><span class="sb">`</span><span class="w"> </span>~/vmrconsole/vmauthd/vmware-authd
</div><div class="line"><a></a><span class="gp">$ </span>ls<span class="w"> </span>-ld<span class="w"> </span>~/vmrconsole/vmauthd/vmware-authd
</div><div class="line"><a></a><span class="go">lrwxrwxrwx 1 vmware vmware 9 Nov 24 04:15 /home/vmware/vmrconsole/vmauthd/vmware-authd -&gt; /bin/true</span>
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>~/vmplayer/vmware-player-app/lib/bin/vmware-remotemks<span class="w"> </span>~/vmrconsole/bin/
</div><div class="line"><a></a><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">0700</span><span class="w"> </span>~/vmrconsole/bin/vmware-remotemks
</div><div class="line"><a></a><span class="gp">$ </span>strings<span class="w"> </span>~/vmrconsole/bin/vmware-remotemks<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>/vmware
</div><div class="line"><a></a><span class="go">/usr/lib/vmware</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/config</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/icu</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/rui.crt</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/rui.key</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/dh512.pem</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/ssl/dh1024.pem</span>
</div><div class="line"><a></a><span class="go">/etc/vmware/CVP</span>
</div><div class="line"><a></a><span class="go">vmauthd/vmware-authd</span>
</div><div class="line"><a></a><span class="go">/usr/sbin/vmware-authd</span>
</div><div class="line"><a></a><span class="go">/var/run/vmware/authd_</span>
</div><div class="line"><a></a><span class="go">/var/run/vmware</span>
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/var/run/vmware,..//////var/run,g&#39;</span><span class="w"> </span>~/vmrconsole/bin/vmware-remotemks
</div><div class="line"><a></a><span class="gp">$ </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s,/etc/vmware/,..//////etc/,g&#39;</span><span class="w"> </span>~/vmrconsole/bin/vmware-remotemks</div></code></pre>
<p>Another attempt:</p>
<pre class="highlight"><input type="radio" name="code_menub9364a57d299f808ce5b4cccb7a7b5b61b54163c" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menub9364a57d299f808ce5b4cccb7a7b5b61b54163c" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>vmrconsole<span class="w"> </span><span class="m">192</span>.168.70.31</div></code></pre>
<p><img alt="VMware Player: hints messages" class="figure" src="../../../../images/howto-vmware-player-as-remote-console-04.jpg"></p>
<p>Ouch, we are presented by a bunch of hints (your mileage may vary since it
depends on the environment), but you surely will see the hint/error message
presented on the above screenshot.</p>
<p>This is not a showstopper if you are an English-only user - just click on the
OK button and you should be able to work with the console, however I think it
is just a right thing to do to fix this little bugger:</p>
<pre class="highlight"><input type="radio" name="code_menu1847d5bc15d53f395bbb77209105078867838f5b" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu1847d5bc15d53f395bbb77209105078867838f5b" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>~/vmplayer<span class="w"> </span>-iname<span class="w"> </span>xkeymap
</div><div class="line"><a></a><span class="go">/home/vmware/vmplayer/vmware-player-app/lib/xkeymap</span>
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/xkeymap<span class="w"> </span>~/vmrconsole/
</div><div class="line"><a></a><span class="gp">$ </span>cp<span class="w"> </span>-aL<span class="w"> </span>/home/vmware/vmplayer/vmware-player-app/lib/vnckeymap<span class="w"> </span>~/vmrconsole/
</div><div class="line"><a></a><span class="gp">$ </span>vmrconsole<span class="w"> </span><span class="m">192</span>.168.70.31</div></code></pre>
<p><img alt="VMware Player: remote console window" class="figure" src="../../../../images/howto-vmware-player-as-remote-console-05.jpg"></p>
<p>We are almost done! At least we achieved the goal we set at the beginning of
this article.</p>
<p>Now, it is time to ensure that all file/directory permissions are strict enough
and to create a tarball, then place it somewhere so we will be able to use our
new tool when the right time comes:</p>
<pre class="highlight"><input type="radio" name="code_menu752f6efb0f90e8a171bcf789b82db9d262ef56e8" class="no-line-numbers icon list-numbered"><input type="radio" name="code_menu752f6efb0f90e8a171bcf789b82db9d262ef56e8" class="line-numbers icon list-numbered"><code class="language-console"><div class="line"><a></a><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>~/vmrconsole
</div><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>.<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-execdir<span class="w"> </span>chmod<span class="w"> </span><span class="m">0700</span><span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="se">\;</span>
</div><div class="line"><a></a><span class="gp">$ </span>find<span class="w"> </span>.<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-execdir<span class="w"> </span>chmod<span class="w"> </span><span class="m">0600</span><span class="w"> </span><span class="s1">&#39;{}&#39;</span><span class="w"> </span><span class="se">\;</span>
</div><div class="line"><a></a><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">0700</span><span class="w"> </span>bin/*
</div><div class="line"><a></a><span class="gp">$ </span><span class="nb">cd</span>
</div><div class="line"><a></a><span class="gp">$ </span>mv<span class="w"> </span>vmrconsole<span class="w"> </span>vmrconsole-3.1.3.324285
</div><div class="line"><a></a><span class="gp">$ </span>tar<span class="w"> </span>cjpf<span class="w"> </span>~/vmrconsole-3.1.3.324285.i386.tar.bz2<span class="w"> </span>vmrconsole-3.1.3.324285
</div><div class="line"><a></a><span class="gp">$ </span>ls<span class="w"> </span>-lh<span class="w"> </span>vmrconsole-3.1.3.324285.i386.tar.bz2<span class="w"> </span>
</div><div class="line"><a></a><span class="go">-rw-r--r-- 1 vmware vmware 13M Nov 24 07:06 vmrconsole-3.1.3.324285.i386.tar.bz2</span></div></code></pre>
<p>P.S. Oh, boy, it takes 2 hours to investigate and to come up with a solution,
then 8 hours to write an article to describe steps to reproduce! I hope that
somebody has found this article useful and I would appreciate any comments.</p>
				<footer>
					<span><span class="contextual">Offloaded on </span><time datetime="2010-11-24T10:00:00+11:00">
						<span class="month"><a href="/2010/11/" title="A link to the archives for November of 2010">Nov<span class="month full">ember</span></a></span>
						<span class="day">24</span>
						<span class="year"><a href="/2010/" title="A link to the archives for the year of 2010">2010</a></span>
					</time></span>
						<span class="contextual">into </span><span class="category"><a href="/category/hacking/" title="A link to a collection of articles in the 'hacking' category">hacking</a></span>
					<span class="contextual">and tagged with:</span>
					<ul class="tags">
						</ul>
				</footer>
			</article>
		<footer>
		</footer>
	</main>
	<footer>
	</footer>
</body>
</html>